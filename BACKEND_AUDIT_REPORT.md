# –û–¢–ß–ï–¢ –ê–£–î–ò–¢–ê BACKEND - PBK CRM

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2026-01-05  
**–ê—É–¥–∏—Ç–æ—Ä:** OpenCode AI  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** PBK CRM Unified  
**–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** 60 –º–∏–Ω—É—Ç  

---

## üìä –û–ë–ó–û–†

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å–µ–≥–æ API —Ñ–∞–π–ª–æ–≤:** 18
- **–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 3,701
- **Framework:** Express.js + Node.js
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL 17.7
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** JWT (jsonwebtoken)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª–µ–π:** bcrypt (10 rounds)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API
```
/api
‚îú‚îÄ‚îÄ /auth          - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (register, login, logout, me)
‚îú‚îÄ‚îÄ /users         - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏  
‚îú‚îÄ‚îÄ /leads         - –õ–∏–¥—ã –∏ —Å–¥–µ–ª–∫–∏
‚îú‚îÄ‚îÄ /clients       - –ö–ª–∏–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ /calls         - –ó–≤–æ–Ω–∫–∏ –∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –∑–≤–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ /tasks         - –ó–∞–¥–∞—á–∏
‚îú‚îÄ‚îÄ /pipelines     - –í–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂
‚îú‚îÄ‚îÄ /dashboard     - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ /proposals     - AI –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ /emails        - Email —Å–æ–æ–±—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ /retell        - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Retell AI
‚îú‚îÄ‚îÄ /agents        - AI –∞–≥–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ /webhooks      - –í–µ–±—Ö—É–∫–∏ (Retell, Telegram)
‚îú‚îÄ‚îÄ /projects      - –ü—Ä–æ–µ–∫—Ç—ã (ERP)
‚îú‚îÄ‚îÄ /expenses      - –†–∞—Å—Ö–æ–¥—ã (ERP)
‚îú‚îÄ‚îÄ /deals         - –°–¥–µ–ª–∫–∏
‚îú‚îÄ‚îÄ /offerteo      - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Offerteo
‚îî‚îÄ‚îÄ /settings      - –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –•–û–†–û–®–û

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
**–§–∞–π–ª:** `backend/src/api/auth.js`, `backend/src/middleware/auth.js`

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π
- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π bcrypt (10 rounds)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email/password –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`is_active`)
- ‚úÖ Role-based access control (RBAC)
- ‚úÖ Permission-based access control
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `last_login_at` –ø—Ä–∏ –≤—Ö–æ–¥–µ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö auth —Å–æ–±—ã—Ç–∏–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ middleware:**
```javascript
- authenticateToken()      // –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
- authorizeRole(...roles)  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- checkPermission(perm)    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
```

**–û—Ü–µ–Ω–∫–∞:** 9/10 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

---

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–¥–∞ ‚≠ê‚≠ê‚≠ê‚≠ê
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–æ–¥—É–ª–∏ (auth, users, leads, etc.)
- ‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (GET, POST, PUT, DELETE)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∫–∞–∂–¥–æ–º —Ä–æ—É—Ç–µ—Ä–µ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ logger utility

**–û—Ü–µ–Ω–∫–∞:** 8/10 ‚≠ê‚≠ê‚≠ê‚≠ê

---

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å SQL ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- ‚úÖ **100% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** (`$1, $2, ...`)
- ‚úÖ **–ù–ï–¢ SQL Injection —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π** (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤–æ –≤—Å–µ—Ö 18 —Ñ–∞–π–ª–∞—Ö)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pg library —Å prepared statements
- ‚úÖ –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û
db.query('SELECT * FROM users WHERE email = $1', [email])
db.query('INSERT INTO leads (title, value) VALUES ($1, $2)', [title, value])

// ‚ùå –¢–ê–ö–ò–• –ù–ï–¢ (—Ö–æ—Ä–æ—à–æ!)
db.query(`SELECT * FROM users WHERE email = '${email}'`) 
```

**–û—Ü–µ–Ω–∫–∞:** 10/10 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

---

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚≠ê‚≠ê‚≠ê‚≠ê
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É `activities` –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫—Ç–æ —Å–æ–∑–¥–∞–ª/–æ–±–Ω–æ–≤–∏–ª –∑–∞–ø–∏—Å—å (`created_by`, `user_id`)
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã:**
```javascript
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏–¥–∞
await db.query(
  `INSERT INTO activities (entity_type, entity_id, activity_type, description, user_id)
   VALUES ('lead', $1, 'created', $2, $3)`,
  [lead_id, `Lead created: ${title}`, req.user.id]
);
```

**–û—Ü–µ–Ω–∫–∞:** 8/10 ‚≠ê‚≠ê‚≠ê‚≠ê

---

### 5. Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Socket.IO) ‚≠ê‚≠ê‚≠ê
- ‚úÖ –°–æ–±—ã—Ç–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–∏–¥–æ–≤ (`lead_created`)
- ‚úÖ –°–æ–±—ã—Ç–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞–¥–∏–∏ –ª–∏–¥–∞ (`lead_stage_changed`)
- ‚úÖ –°–æ–±—ã—Ç–∏—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –Ω–∞ –∑–≤–æ–Ω–∫–∏ (`call_request_created`)
- ‚úÖ –°–æ–±—ã—Ç–∏—è –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –∑–≤–æ–Ω–∫–∞ (`call_started`)

**–û—Ü–µ–Ω–∫–∞:** 7/10 ‚≠ê‚≠ê‚≠ê

---

## ‚ö†Ô∏è –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (P0) üî¥

#### P0-1: JWT_SECRET –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ
**–§–∞–π–ª:** `backend/src/middleware/auth.js:24`, `backend/src/api/auth.js:57,138`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ `process.env.JWT_SECRET` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–ø–∞–¥–µ—Ç –±–µ–∑ –ø–æ–Ω—è—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```javascript
jwt.sign({ id: user.id }, process.env.JWT_SECRET, { expiresIn: '7d' })
```

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –í –Ω–∞—á–∞–ª–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (server.js –∏–ª–∏ config.js)
if (!process.env.JWT_SECRET) {
  throw new Error('JWT_SECRET environment variable is required');
}
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0

---

#### P0-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –Ω–∞ /auth/login
**–§–∞–π–ª:** `backend/src/api/auth.js:77`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç brute-force –∞—Ç–∞–∫ –Ω–∞ –ª–æ–≥–∏–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const rateLimit = require('express-rate-limit');

const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 5, // 5 –ø–æ–ø—ã—Ç–æ–∫
  message: 'Too many login attempts, please try again later'
});

router.post('/login', loginLimiter, async (req, res) => { ... });
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å brute-force –∞—Ç–∞–∫  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0

---

#### P0-3: –ü–∞—Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 'changeme' –≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ
**–§–∞–π–ª:** `backend/src/api/users.js:86`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–¥–º–∏–Ω–æ–º, –ø–∞—Ä–æ–ª—å 'changeme' –Ω–µ —Ö–µ—à–∏—Ä—É–µ—Ç—Å—è

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```javascript
[email, 'changeme', first_name, ...] // ‚ùå –ü–∞—Ä–æ–ª—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ!
```

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const defaultPasswordHash = await bcrypt.hash('changeme', 10);
[email, defaultPasswordHash, first_name, ...]
```

**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞, —É—è–∑–≤–∏–º–æ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0

---

### –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (P1) üü†

#### P1-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email —Ñ–æ—Ä–º–∞—Ç–∞
**–§–∞–π–ª—ã:** `auth.js`, `users.js`, `clients.js`  
**–ü—Ä–æ–±–ª–µ–º–∞:** Email –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
if (!emailRegex.test(email)) {
  return res.status(400).json({ success: false, error: 'Invalid email format' });
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1

---

#### P1-2: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–æ—É—Ç–µ—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ auth middleware
**–§–∞–π–ª:** `backend/src/api/clients.js:188`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –≠–Ω–¥–ø–æ–∏–Ω—Ç `/api/clients/:id/emails` –ù–ï –∑–∞—â–∏—â–µ–Ω `authenticateToken`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```javascript
router.get('/:id/emails', async (req, res) => { ... } // ‚ùå –ù–µ—Ç auth!
```

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
router.get('/:id/emails', authenticateToken, async (req, res) => { ... }
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π - —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1

---

#### P1-3: –°–ª–∞–±–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
**–§–∞–π–ª—ã:** `calls.js`, `retell.js`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Retell AI

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const phoneRegex = /^\+?[1-9]\d{1,14}$/; // E.164 —Ñ–æ—Ä–º–∞—Ç
if (!phoneRegex.test(phone_number)) {
  return res.status(400).json({ 
    success: false, 
    error: 'Invalid phone number format. Use E.164 format' 
  });
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1

---

#### P1-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ä–µ—Å—É—Ä—Å–∞
**–§–∞–π–ª:** `backend/src/api/users.js:99-104`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ `req.user.id !== req.params.id` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è UUID –≤ —Å—Ç—Ä–æ–∫–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
if (req.user.role !== 'admin' && req.user.id.toString() !== req.params.id.toString()) {
  return res.status(403).json({ success: false, error: 'Forbidden' });
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1

---

#### P1-5: Webhooks –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã
**–§–∞–π–ª:** `backend/src/api/webhooks.js`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–µ–±—Ö—É–∫–∏ Retell –∏ Telegram –Ω–µ –∏–º–µ—é—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```javascript
router.post('/retell', (req, res) => {
  res.json({ success: true }); // ‚ùå –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –í–°–ï –∑–∞–ø—Ä–æ—Å—ã!
});
```

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
router.post('/retell', (req, res) => {
  const signature = req.headers['x-retell-signature'];
  if (!verifyRetellSignature(req.body, signature)) {
    return res.status(401).json({ error: 'Invalid signature' });
  }
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook
});
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π - –ø–æ–¥–¥–µ–ª–∫–∞ webhook —Å–æ–±—ã—Ç–∏–π  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1

---

### –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (P2) üü°

#### P2-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ pagination count
**–§–∞–π–ª—ã:** –í—Å–µ API —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è total count –∑–∞–ø–∏—Å–µ–π –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const countResult = await db.query('SELECT COUNT(*) FROM leads WHERE ...');
res.json({
  success: true,
  data: result.rows,
  pagination: {
    total: parseInt(countResult.rows[0].count),
    limit, offset
  }
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P2

---

#### P2-2: –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∏—Å–∫ –ø–æ `email`, `phone`, `company_name` –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º

**–†–µ—à–µ–Ω–∏–µ (migrations):**
```sql
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_clients_email ON clients(email);
CREATE INDEX idx_clients_company_name ON clients(company_name);
CREATE INDEX idx_leads_assigned_to ON leads(assigned_to);
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_tasks_due_date ON tasks(due_date);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P2

---

#### P2-3: CORS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CORS

**–†–µ—à–µ–Ω–∏–µ (–≤ server.js):**
```javascript
const cors = require('cors');
app.use(cors({
  origin: process.env.FRONTEND_URL || 'http://localhost:3010',
  credentials: true
}));
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P2

---

#### P2-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π
**–§–∞–π–ª—ã:** `clients.js`, `leads.js`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –æ–¥–Ω–∏–º email

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ INSERT
const existing = await db.query(
  'SELECT id FROM clients WHERE email = $1', [email]
);
if (existing.rows.length > 0) {
  return res.status(409).json({ 
    success: false, 
    error: 'Client with this email already exists' 
  });
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P2

---

#### P2-5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ soft delete
**–ü—Ä–æ–±–ª–µ–º–∞:** DELETE –∑–∞–ø—Ä–æ—Å—ã —É–¥–∞–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞–≤—Å–µ–≥–¥–∞

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ deleted_at –≤ —Ç–∞–±–ª–∏—Ü—ã
// –í–º–µ—Å—Ç–æ DELETE –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
UPDATE leads SET deleted_at = NOW() WHERE id = $1
// –í SELECT –¥–æ–±–∞–≤–ª—è—Ç—å WHERE deleted_at IS NULL
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P2

---

#### P2-6: –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
**–§–∞–π–ª:** `calls.js:169-196` (approve call request)  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ Retell API —É–ø–∞–¥–µ—Ç, –∑–∞–ø—Ä–æ—Å –æ—Å—Ç–∞–Ω–µ—Ç—Å—è approved, –Ω–æ –∑–≤–æ–Ω–æ–∫ –Ω–µ —Å–æ–∑–¥–∞—Å—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const client = await db.pool.connect();
try {
  await client.query('BEGIN');
  
  // Update request
  await client.query('UPDATE call_requests SET status = $1 ...', [...]);
  
  // Create call in Retell
  const retellResult = await retellService.createCall(...);
  
  // Save to DB
  await client.query('INSERT INTO calls ...', [...]);
  
  await client.query('COMMIT');
} catch (e) {
  await client.query('ROLLBACK');
  throw e;
} finally {
  client.release();
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P2

---

### –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (P3) üü¢

#### P3-1: Inconsistent error responses
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–Ω–æ–≥–¥–∞ `{ success, error }`, –∏–Ω–æ–≥–¥–∞ `{ error }`, –∏–Ω–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç

**–†–µ—à–µ–Ω–∏–µ:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
```javascript
// Success
{ success: true, data: ... }

// Error
{ success: false, error: 'message', code: 'ERROR_CODE' }
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P3

---

#### P3-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ API versioning
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–∞ `/api/...` –±–µ–∑ –≤–µ—Ä—Å–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
app.use('/api/v1', routes);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P3

---

#### P3-3: Hardcoded limits –∏ offsets
**–ü—Ä–æ–±–ª–µ–º–∞:** `limit = 50` —Ö–∞—Ä–¥–∫–æ–¥–µ–Ω –≤–æ –º–Ω–æ–≥–∏—Ö –º–µ—Å—Ç–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
const DEFAULT_LIMIT = 50;
const MAX_LIMIT = 100;
const limit = Math.min(parseInt(req.query.limit) || DEFAULT_LIMIT, MAX_LIMIT);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P3

---

#### P3-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ request validation library
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä—É—á–Ω—É—é –≤ –∫–∞–∂–¥–æ–º —Ä–æ—É—Ç–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å joi –∏–ª–∏ express-validator
```javascript
const { body, validationResult } = require('express-validator');

router.post('/leads', [
  body('title').notEmpty().trim(),
  body('value').optional().isNumeric(),
  authenticateToken
], async (req, res) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({ success: false, errors: errors.array() });
  }
  ...
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P3

---

#### P3-5: console.log –≤–º–µ—Å—Ç–æ logger
**–§–∞–π–ª—ã:** `retell.js`, `proposals.js`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `console.error` –≤–º–µ—Å—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ logger

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ console.error –Ω–∞:
logger.error('Error message', { context: error });
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P3

---

#### P3-6: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ health check endpoint
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç `/api/health` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
router.get('/health', async (req, res) => {
  try {
    await db.query('SELECT 1');
    res.json({ 
      success: true, 
      status: 'healthy',
      timestamp: new Date().toISOString(),
      uptime: process.uptime()
    });
  } catch (error) {
    res.status(503).json({ 
      success: false, 
      status: 'unhealthy',
      error: error.message 
    });
  }
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P3

---

## üìà –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞

1. **N+1 –∑–∞–ø—Ä–æ—Å—ã** - –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö:
   ```javascript
   // ‚ùå –ü–õ–û–•–û
   const leads = await db.query('SELECT * FROM leads');
   for (let lead of leads.rows) {
     const client = await db.query('SELECT * FROM clients WHERE id = $1', [lead.client_id]);
   }
   
   // ‚úÖ –•–û–†–û–®–û (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
   SELECT l.*, c.company_name FROM leads l LEFT JOIN clients c ON l.client_id = c.id
   ```
   **–°—Ç–∞—Ç—É—Å:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å JOIN ‚úÖ

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ connection pooling config**
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ pg pool –≤ `database/db.js`

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**
   - Dashboard metrics –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–∞—Å—Ç–æ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã (Redis)

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ - –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------|-------------|
| SQL Injection | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10/10 | –û—Ç–ª–∏—á–Ω–æ - –≤–µ–∑–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã |
| Authentication | ‚≠ê‚≠ê‚≠ê‚≠ê 8/10 | –•–æ—Ä–æ—à–æ, –Ω–æ –Ω—É–∂–µ–Ω rate limiting |
| Authorization | ‚≠ê‚≠ê‚≠ê‚≠ê 8/10 | RBAC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω–æ 1 —ç–Ω–¥–ø–æ–∏–Ω—Ç –±–µ–∑ auth |
| Password Security | ‚≠ê‚≠ê‚≠ê 6/10 | bcrypt —Ö–æ—Ä–æ—à, –Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å 'changeme' |
| API Security | ‚≠ê‚≠ê‚≠ê 6/10 | –ù–µ—Ç –∑–∞—â–∏—Ç—ã webhooks, –Ω–µ—Ç CORS |
| Input Validation | ‚≠ê‚≠ê‚≠ê 6/10 | –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è, –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 7.3/10 ‚≠ê‚≠ê‚≠ê‚≠ê

---

## üìä –ö–ê–ß–ï–°–¢–í–û –ö–û–î–ê

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | ‚≠ê‚≠ê‚≠ê‚≠ê 8/10 | –•–æ—Ä–æ—à–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–æ –ø–æ –º–æ–¥—É–ª—è–º |
| –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê‚≠ê 8/10 | –ü–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –µ—Å—Ç—å |
| DRY –ø—Ä–∏–Ω—Ü–∏–ø | ‚≠ê‚≠ê‚≠ê 6/10 | –ï—Å—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ |
| Error Handling | ‚≠ê‚≠ê‚≠ê‚≠ê 7/10 | try/catch –≤–µ–∑–¥–µ, –Ω–æ inconsistent |
| Logging | ‚≠ê‚≠ê‚≠ê 6/10 | –ï—Å—Ç—å, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è logger |
| Testing | ‚≠ê 2/10 | Unit —Ç–µ—Å—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞:** 6.2/10 ‚≠ê‚≠ê‚≠ê

---

## üîß –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### 1. Retell AI (–ì–æ–ª–æ—Å–æ–≤—ã–µ –∑–≤–æ–Ω–∫–∏) ‚≠ê‚≠ê‚≠ê
**–§–∞–π–ª:** `backend/src/api/retell.js`

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–≤–æ–Ω–∫–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–≤–æ–Ω–∫–∞
- ‚úÖ –°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è AI
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤ –≤ –ë–î

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ webhook –æ—Ç Retell (webhooks.js –ø—É—Å—Ç–æ–π)
- ‚ùå –ù–µ—Ç retry –ª–æ–≥–∏–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- ‚ùå API –∫–ª—é—á –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ

**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–û—Ü–µ–Ω–∫–∞:** 6/10

---

### 2. OpenAI (–ü–µ—Ä–µ–≤–æ–¥ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤) ‚≠ê‚≠ê
**–§–∞–π–ª:** `backend/src/api/calls.js:269`

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ü–µ—Ä–µ–≤–æ–¥ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤ –∑–≤–æ–Ω–∫–æ–≤
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ JSONB –ø–æ–ª–µ

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –°–µ—Ä–≤–∏—Å `openai/service` –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–¥–µ
- ‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏

**–°—Ç–∞—Ç—É—Å:** –°–æ–º–Ω–∏—Ç–µ–ª—å–Ω–æ  
**–û—Ü–µ–Ω–∫–∞:** 4/10

---

### 3. Telegram Bot ‚≠ê
**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå Webhook –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è (webhooks.js:8-10 –ø—É—Å—Ç–æ–π)
- ‚ùå –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å API

**–°—Ç–∞—Ç—É—Å:** –ù–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω  
**–û—Ü–µ–Ω–∫–∞:** 2/10

---

## üìã SUMMARY - –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### MUST FIX (P0) - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **P0-1:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É JWT_SECRET –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. **P0-2:** –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ /auth/login
3. **P0-3:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è 'changeme'

**–í—Ä–µ–º—è:** ~2 —á–∞—Å–∞  
**–†–∏—Å–∫ –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –í–´–°–û–ö–ò–ô

---

### SHOULD FIX (P1) - –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. **P1-1:** –í–∞–ª–∏–¥–∞—Ü–∏—è email —Ñ–æ—Ä–º–∞—Ç–∞
2. **P1-2:** –î–æ–±–∞–≤–∏—Ç—å auth –Ω–∞ `/clients/:id/emails`
3. **P1-3:** –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
4. **P1-4:** –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ä–µ—Å—É—Ä—Å–∞
5. **P1-5:** –ó–∞—â–∏—Ç–∞ webhooks (Retell, Telegram)

**–í—Ä–µ–º—è:** ~3 —á–∞—Å–∞  
**–†–∏—Å–∫ –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –°–†–ï–î–ù–ò–ô

---

### NICE TO HAVE (P2) - –£–ª—É—á—à–µ–Ω–∏—è
1. **P2-1:** Pagination —Å total count
2. **P2-2:** –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î
3. **P2-3:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS
4. **P2-4:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π
5. **P2-5:** Soft delete
6. **P2-6:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–í—Ä–µ–º—è:** ~4 —á–∞—Å–∞  
**–†–∏—Å–∫ –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –ù–ò–ó–ö–ò–ô

---

### REFACTORING (P3) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **P3-1:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è error responses
2. **P3-2:** API versioning
3. **P3-3:** –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è limits
4. **P3-4:** Request validation library
5. **P3-5:** –ó–∞–º–µ–Ω–∞ console.log –Ω–∞ logger
6. **P3-6:** Health check endpoint

**–í—Ä–µ–º—è:** ~3 —á–∞—Å–∞  
**–†–∏—Å–∫ –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô

---

## üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –û–¶–ï–ù–ö–ê BACKEND

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û—Ü–µ–Ω–∫–∞ |
|-----------|--------|
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | 7.3/10 ‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** | 6.2/10 ‚≠ê‚≠ê‚≠ê |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 7.0/10 ‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** | 4.0/10 ‚≠ê‚≠ê |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | 2.0/10 ‚≠ê |

### **–û–ë–©–ê–Ø –û–¶–ï–ù–ö–ê: 5.3/10** ‚≠ê‚≠ê‚≠ê

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –Ω–µ–¥–µ–ª–∏)
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ P0 –ø—Ä–æ–±–ª–µ–º—ã
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å P1 –ø—Ä–æ–±–ª–µ–º—ã
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è auth –∏ critical paths
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å health check endpoint
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (1 –º–µ—Å—è—Ü)
1. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ P2 —É–ª—É—á—à–µ–Ω–∏—è
2. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å request validation library
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å API rate limiting –Ω–∞ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
5. ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Telegram bot

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (2-3 –º–µ—Å—è—Ü–∞)
1. ‚úÖ –î–æ—Å—Ç–∏—á—å 80%+ –ø–æ–∫—Ä—ã—Ç–∏—è unit —Ç–µ—Å—Ç–∞–º–∏
2. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å API versioning
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus + Grafana)
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å distributed tracing (Jaeger)
5. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å API (Swagger/OpenAPI)

---

## üìÅ –§–ê–ô–õ–´ –î–õ–Ø –ü–†–ò–û–†–ò–¢–ï–¢–ù–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

```
backend/src/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ auth.js          ‚ö†Ô∏è P0-1, P0-2
‚îÇ   ‚îú‚îÄ‚îÄ users.js         ‚ö†Ô∏è P0-3, P1-2, P1-4
‚îÇ   ‚îú‚îÄ‚îÄ webhooks.js      ‚ö†Ô∏è P1-5
‚îÇ   ‚îú‚îÄ‚îÄ calls.js         ‚ö†Ô∏è P1-3
‚îÇ   ‚îú‚îÄ‚îÄ clients.js       ‚ö†Ô∏è P1-1, P1-2
‚îÇ   ‚îî‚îÄ‚îÄ retell.js        ‚ö†Ô∏è P1-3
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îî‚îÄ‚îÄ auth.js          ‚ö†Ô∏è P0-1
‚îî‚îÄ‚îÄ server.js            ‚ö†Ô∏è P2-3 (CORS), P3-6 (health)
```

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ê–£–î–ò–¢ FRONTEND  
**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è:** 60 –º–∏–Ω—É—Ç

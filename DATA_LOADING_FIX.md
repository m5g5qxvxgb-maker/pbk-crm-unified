# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö - –ó–ê–í–ï–†–®–ï–ù–û

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ https://appp2p-01.tail96f20b.ts.net –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö (–ª–∏–¥—ã, –∫–ª–∏–µ–Ω—Ç—ã, –∑–∞–¥–∞—á–∏ –∏ —Ç.–¥.).

## –ü—Ä–∏—á–∏–Ω–∞
Frontend –±—ã–ª —Å–æ–±—Ä–∞–Ω —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `NEXT_PUBLIC_API_URL=http://backend:5002`, –∫–æ—Ç–æ—Ä–∞—è **–≤—Å—Ç—Ä–æ–∏–ª–∞—Å—å –≤ JavaScript –∫–æ–¥** –ø—Ä–∏ —Å–±–æ—Ä–∫–µ. 

–ö–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä –ø—ã—Ç–∞–ª—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –æ–Ω –¥–µ–ª–∞–ª –∑–∞–ø—Ä–æ—Å—ã –∫ `http://backend:5002/api/leads`, –Ω–æ `backend:5002` - —ç—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–µ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–ª–æ —Ä–∞–Ω—å—à–µ:
```
–ë—Ä–∞—É–∑–µ—Ä ‚Üí –ø—ã—Ç–∞–µ—Ç—Å—è GET http://backend:5002/api/leads
         ‚ùå DNS –æ—à–∏–±–∫–∞: "backend" –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

### –ö–∞–∫ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
```
–ë—Ä–∞—É–∑–µ—Ä ‚Üí GET https://appp2p-01.tail96f20b.ts.net/api/leads
         ‚Üì
       Nginx ‚Üí –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ http://127.0.0.1:5002/api/leads
         ‚Üì
      Backend ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
```

## –†–µ—à–µ–Ω–∏–µ
1. **–£–¥–∞–ª–∏–ª–∏** `NEXT_PUBLIC_API_URL` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. **–ü–µ—Ä–µ—Å–æ–±—Ä–∞–ª–∏** frontend –±–µ–∑ —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. Frontend —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏** (`/api/leads` –≤–º–µ—Å—Ç–æ `http://backend:5002/api/leads`)
4. Nginx –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ backend

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã
```bash
# API —Ä–∞–±–æ—Ç–∞–ª —á–µ—Ä–µ–∑ curl
curl -H "Authorization: Bearer $TOKEN" https://appp2p-01.tail96f20b.ts.net/api/leads
# ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–ª –¥–∞–Ω–Ω—ã–µ

# –ù–æ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –¥–µ–ª–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
tail -f /var/log/nginx/access.log | grep '/api/'
# ‚ùå –ù–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞
```

### 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
docker exec pbk-frontend printenv | grep API
# –†–µ–∑—É–ª—å—Ç–∞—Ç: NEXT_PUBLIC_API_URL=http://backend:5002
# ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –±—Ä–∞—É–∑–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ backend:5002
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
cd /root/pbk-crm-unified
git pull
docker-compose -f docker-compose.server.yml build --no-cache frontend
docker-compose -f docker-compose.server.yml up -d frontend
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
docker exec pbk-frontend printenv | grep API
# –†–µ–∑—É–ª—å—Ç–∞—Ç: API_URL=http://backend:5002 (—Ç–æ–ª—å–∫–æ –¥–ª—è server-side)
# ‚úÖ NEXT_PUBLIC_API_URL –±–æ–ª—å—à–µ –Ω–µ—Ç
```

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### ‚ÄºÔ∏è –í–ê–ñ–ù–û: –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ!

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è **–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É**, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤—ã–π JavaScript –∫–æ–¥:

**macOS Safari/Chrome**: `Cmd + Shift + R` (–∂—ë—Å—Ç–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
**Windows/Linux**: `Ctrl + Shift + R` –∏–ª–∏ `Ctrl + F5`

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ:
- –ó–∞–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É
- –û—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–Ω–æ–≤–æ https://appp2p-01.tail96f20b.ts.net

### –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
1. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É (admin@pbkconstruction.net / admin123)
2. –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–õ–∏–¥—ã, –ö–ª–∏–µ–Ω—Ç—ã, –ó–∞–¥–∞—á–∏) –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í –±—Ä–∞—É–∑–µ—Ä–µ:
- –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
- –í–∫–ª–∞–¥–∫–∞ "Network" (–°–µ—Ç—å)
- –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å—ã:
  - `GET /api/leads` ‚Üí Status 200
  - `GET /api/clients` ‚Üí Status 200
  - `GET /api/tasks` ‚Üí Status 200

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
# –õ–æ–≥–∏ nginx –ø–æ–∫–∞–∂—É—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞
ssh root@100.91.124.46 "tail -f /var/log/nginx/access.log | grep '/api/'"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
# 127.0.0.1 - "GET /api/leads HTTP/1.1" 200 2872 "https://appp2p-01..."
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Frontend environment (docker-compose.server.yml)
```yaml
environment:
  NODE_ENV: production
  API_URL: http://backend:5002  # –¢–æ–ª—å–∫–æ –¥–ª—è server-side rewrites
  PORT: 3010
  # NEXT_PUBLIC_API_URL —É–¥–∞–ª–µ–Ω–∞!
```

### Frontend –∫–æ–¥ (lib/api.ts)
```typescript
const API_URL = process.env.NEXT_PUBLIC_API_URL || '';
// NEXT_PUBLIC_API_URL –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ ‚Üí API_URL = ''

const api = axios.create({
  baseURL: API_URL || '/api',  // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è '/api'
  // ...
});
```

### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (/etc/nginx/sites-available/pbk-crm)
```nginx
# Frontend
location / {
    proxy_pass http://127.0.0.1:3010;
}

# Backend API
location /api/ {
    proxy_pass http://127.0.0.1:5002/api/;
}
```

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
5 —è–Ω–≤–∞—Ä—è 2026, 08:53 CET

## –°—Ç–∞—Ç—É—Å
üü¢ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- [LOGIN_FIX_COMPLETE.md](LOGIN_FIX_COMPLETE.md) - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–Ω–∞
- [nginx-pbk-crm.conf](nginx-pbk-crm.conf) - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
- [PRODUCTION_DEPLOYMENT_COMPLETE.md](PRODUCTION_DEPLOYMENT_COMPLETE.md) - –û—Ç—á—ë—Ç –æ –¥–µ–ø–ª–æ–µ

════════════════════════════════════════════════════════════════════════════════
                    PBK CRM UNIFIED SYSTEM - ВИЗУАЛЬНЫЙ ОБЗОР
════════════════════════════════════════════════════════════════════════════════

📦 ПРОЕКТ: /root/pbk-crm-unified/

┌────────────────────────────────────────────────────────────────────────────┐
│                          �� АРХИТЕКТУРА СИСТЕМЫ                            │
└────────────────────────────────────────────────────────────────────────────┘

                        ┌──────────────────────────┐
                        │   Cloudflare Tunnel      │
                        │ crm.pbkconstruction.net  │
                        └────────────┬─────────────┘
                                     │
                        ┌────────────┴─────────────┐
                        │                          │
              ┌─────────▼─────────┐      ┌────────▼────────┐
              │   FRONTEND        │      │   BACKEND       │
              │   Next.js 14      │◄────►│   Express       │
              │   TypeScript      │ API  │   Node.js       │
              │   Port: 3000      │      │   Port: 5000    │
              └───────────────────┘      └────────┬────────┘
                                                  │
                              ┌───────────────────┼───────────────────┐
                              │                   │                   │
                    ┌─────────▼────────┐  ┌──────▼──────┐  ┌────────▼────────┐
                    │   PostgreSQL     │  │   Redis     │  │  External APIs  │
                    │   Database       │  │   Cache     │  │                 │
                    │   Port: 5432     │  │   Port:6379 │  │ • Retell AI     │
                    └──────────────────┘  └─────────────┘  │ • OpenAI        │
                                                           │ • SMTP/IMAP     │
                                                           │ • Telegram      │
                                                           └─────────────────┘

          ┌────────────────────────────────────────────────────────┐
          │          COPILOT AGENT (отдельный процесс)             │
          │          • Telegram Bot                                │
          │          • AI-powered (OpenAI GPT-4)                   │
          │          • Ограничен /root/pbk-crm-unified/            │
          │          • Управление CRM через чат                    │
          └────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────┐
│                        📁 СТРУКТУРА ДИРЕКТОРИЙ                             │
└────────────────────────────────────────────────────────────────────────────┘

pbk-crm-unified/
│
├── 📄 Документация (18 файлов)
│   ├── START_HERE.md              ← 🎯 НАЧНИТЕ ЗДЕСЬ
│   ├── README.md                  ← Полное описание
│   ├── QUICKSTART.md              ← Быстрый старт
│   ├── SETUP.md                   ← Установка
│   ├── CREDENTIALS_GUIDE.md       ← Все креды
│   ├── PROJECT_OVERVIEW.md        ← Обзор проекта
│   ├── DEVELOPMENT_ROADMAP.md     ← План разработки
│   ├── NEXT_STEPS.md              ← Следующие шаги
│   ├── FILE_STRUCTURE.md          ← Карта файлов
│   ├── PROJECT_SUMMARY.md         ← Краткая сводка
│   ├── VISUAL_OVERVIEW.txt        ← Этот файл
│   ├── .env.example               ← Пример переменных
│   ├── .gitignore                 ← Git ignore
│   ├── docker-compose.yml         ← Docker config
│   └── package.json               ← Root dependencies
│
├── 📁 frontend/                   ← Next.js приложение
│   ├── app/
│   │   ├── dashboard/            ← 📊 Дашборд
│   │   ├── leads/                ← 👥 Лиды
│   │   ├── clients/              ← 🏢 Клиенты
│   │   ├── calls/                ← 📞 Звонки (Retell AI) ⭐
│   │   ├── emails/               ← ✉️ Почта
│   │   ├── proposals/            ← 💼 Предложения
│   │   ├── pipelines/            ← 🎯 Воронки продаж
│   │   └── settings/             ← ⚙️ Настройки ⭐
│   ├── components/
│   │   ├── ui/                   ← UI компоненты
│   │   ├── layout/               ← Layout
│   │   └── features/             ← Feature компоненты
│   ├── lib/                      ← Утилиты
│   ├── hooks/                    ← React hooks
│   └── public/                   ← Статика
│
├── 📁 backend/                    ← Express API
│   └── src/
│       ├── index.js              ← ⭐ Main server
│       ├── api/                  ← API routes
│       │   ├── auth.js           ← Авторизация
│       │   ├── users.js          ← Пользователи
│       │   ├── clients.js        ← Клиенты
│       │   ├── leads.js          ← Лиды
│       │   ├── calls.js          ← ✅ Звонки (готово!)
│       │   ├── emails.js         ← Почта
│       │   ├── proposals.js      ← Предложения
│       │   ├── pipelines.js      ← Воронки
│       │   ├── settings.js       ← Настройки
│       │   ├── webhooks.js       ← Webhooks
│       │   └── dashboard.js      ← Dashboard API
│       ├── services/
│       │   ├── retell/           ← ✅ Retell AI (готово!)
│       │   ├── openai/           ← ✅ OpenAI (готово!)
│       │   ├── email/            ← SMTP/IMAP
│       │   └── telegram/         ← Telegram боты
│       ├── database/
│       │   └── db.js             ← ✅ DB connection
│       ├── middleware/           ← Auth, validation, etc.
│       └── utils/
│           └── logger.js         ← ✅ Winston logger
│
├── 📁 copilot-agent/              ← 🤖 AI Copilot
│   ├── index.js                  ← ✅ Telegram bot
│   ├── SYSTEM_PROMPT.md          ← ✅ Системный промпт
│   ├── commands/                 ← Команды (TODO)
│   └── utils/                    ← Утилиты
│
├── 📁 database/                   ← PostgreSQL
│   ├── schema.sql                ← ✅ Полная схема
│   ├── migrations/               ← Миграции (TODO)
│   └── seeds/                    ← Seed данные (TODO)
│
├── 📁 config/                     ← Конфигурация
├── 📁 scripts/                    ← Утилиты
└── 📁 docs/                       ← Доп. документация

┌────────────────────────────────────────────────────────────────────────────┐
│                        🎯 ОСНОВНЫЕ ВОЗМОЖНОСТИ                             │
└────────────────────────────────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════════════════════════╗
║ 📊 CRM CORE                                                                ║
╠════════════════════════════════════════════════════════════════════════════╣
║ ✅ Управление лидами и клиентами                                          ║
║ ✅ Настраиваемые воронки продаж (создание через NLP)                      ║
║ ✅ История всех взаимодействий                                             ║
║ ✅ Дашборд с метриками в реальном времени                                  ║
╚════════════════════════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════════════════════════╗
║ 📞 RETELL AI - ЗВОНКИ                                                      ║
╠════════════════════════════════════════════════════════════════════════════╣
║ ✅ Workflow звонков:                                                       ║
║    1. Создание заявки (пользователь с can_create_calls)                   ║
║    2. Подтверждение (пользователь с can_approve_calls)                    ║
║    3. Автоматический звонок через Retell AI                               ║
║                                                                            ║
║ ✅ Просмотр ВСЕХ звонков                                                   ║
║ ✅ Расшифровка каждого звонка                                              ║
║ ✅ Перевод расшифровок на любой язык                                       ║
║ ✅ Дополнительные инструкции для каждого звонка                            ║
║ ✅ Настройка системных промптов в CRM Settings                             ║
║ ✅ Настройка Knowledge Base в CRM Settings                                 ║
║ ✅ Сводка по звонкам в карточках клиентов/лидов                            ║
╚════════════════════════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════════════════════════╗
║ ✉️ КОРПОРАТИВНАЯ ПОЧТА                                                     ║
╠════════════════════════════════════════════════════════════════════════════╣
║ ✅ Отправка писем через SMTP (настройка в CRM)                             ║
║ ✅ Получение писем через IMAP                                              ║
║ ✅ Интеграция с карточками клиентов                                        ║
║ ✅ Шаблоны писем                                                           ║
║ ✅ История переписки                                                       ║
╚════════════════════════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════════════════════════╗
║ 💼 OPENAI - AI ПРЕДЛОЖЕНИЯ                                                 ║
╠════════════════════════════════════════════════════════════════════════════╣
║ ✅ Генерация коммерческих предложений                                      ║
║ ✅ Расчет через API OpenAI                                                 ║
║ ✅ Использование корпоративных шаблонов                                    ║
║ ✅ Автоматическая отправка клиентам                                        ║
║ ✅ Перевод текстов                                                         ║
╚════════════════════════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════════════════════════╗
║ 🤖 COPILOT AGENT                                                           ║
╠════════════════════════════════════════════════════════════════════════════╣
║ ✅ Специализированный AI-ассистент                                         ║
║ ✅ Управление через Telegram                                               ║
║ ✅ Ограничен доступом только к /root/pbk-crm-unified/                      ║
║ ✅ Выполнение задач:                                                       ║
║    • Создание лидов                                                        ║
║    • Управление звонками                                                   ║
║    • Отправка писем                                                        ║
║    • Генерация отчетов                                                     ║
║    • Статистика и аналитика                                                ║
╚════════════════════════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════════════════════════╗
║ 📱 TELEGRAM INTEGRATION                                                    ║
╠════════════════════════════════════════════════════════════════════════════╣
║ ✅ Fixly Bot - управление звонками                                         ║
║ ✅ Copilot Bot - AI управление CRM                                         ║
║ ✅ Уведомления о событиях                                                  ║
║ ✅ Создание и подтверждение звонков через чат                              ║
╚════════════════════════════════════════════════════════════════════════════╝

┌────────────────────────────────────────────────────────────────────────────┐
│                        📊 ПРОГРЕСС РАЗРАБОТКИ                              │
└────────────────────────────────────────────────────────────────────────────┘

Общий прогресс: ████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 25%

├─ ✅ Документация:        ████████████████████████████████████████ 100%
├─ ✅ Структура проекта:   ████████████████████████████████████████ 100%
├─ ✅ База данных:         ████████████████████████████████████░░░░  90%
├─ ✅ Docker config:       ████████████████████████████████████████ 100%
├─ 🚧 Backend API:         ████████████░░░░░░░░░░░░░░░░░░░░░░░░░░  30%
├─ 🚧 Frontend:            ████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  10%
├─ 🚧 Copilot Agent:       ████████████████████████░░░░░░░░░░░░░░  60%
├─ ⏳ Интеграции:          ████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  20%
└─ ⏳ Testing:             ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%

┌────────────────────────────────────────────────────────────────────────────┐
│                        🎯 СЛЕДУЮЩИЕ ШАГИ                                   │
└────────────────────────────────────────────────────────────────────────────┘

ПРИОРИТЕТ #1: Backend API (3-5 дней)
  □ auth.js
  □ users.js
  □ clients.js
  □ leads.js
  □ settings.js ⭐ КРИТИЧНО
  □ pipelines.js
  □ emails.js
  □ proposals.js
  □ Middleware

ПРИОРИТЕТ #2: Frontend Settings Page (2-3 дня) ⭐⭐⭐
  □ Retell AI настройки
  □ OpenAI настройки
  □ Email настройки
  □ Telegram настройки
  □ Pipelines настройки

ПРИОРИТЕТ #3: Frontend Calls Page (2-3 дня) ⭐⭐
  □ Список звонков
  □ Создание заявок
  □ Подтверждение
  □ Расшифровки
  □ Переводы

ПРИОРИТЕТ #4: Остальное (5-7 дней)
  □ Dashboard
  □ Leads/Clients pages
  □ Email integration
  □ Telegram bots
  □ Socket.io real-time

┌────────────────────────────────────────────────────────────────────────────┐
│                        🔑 НЕОБХОДИМЫЕ КРЕДЫ                                │
└────────────────────────────────────────────────────────────────────────────┘

✓ PostgreSQL:           DATABASE_URL
✓ Retell AI:            RETELL_API_KEY, RETELL_AGENT_ID
✓ OpenAI:               OPENAI_API_KEY
✓ Telegram (основной):  TELEGRAM_BOT_TOKEN
✓ Telegram (Copilot):   COPILOT_TELEGRAM_BOT_TOKEN
✓ SMTP/IMAP:            SMTP_USER, SMTP_PASSWORD, IMAP_USER, IMAP_PASSWORD
✓ JWT:                  JWT_SECRET, SESSION_SECRET
✓ Cloudflare:           CLOUDFLARE_TUNNEL_TOKEN

Подробно: см. CREDENTIALS_GUIDE.md

┌────────────────────────────────────────────────────────────────────────────┐
│                        🚀 КАК НАЧАТЬ                                       │
└────────────────────────────────────────────────────────────────────────────┘

1️⃣  Прочитайте:
    $ cat START_HERE.md

2️⃣  Для разработки:
    $ cat NEXT_STEPS.md

3️⃣  Для установки:
    $ cat SETUP.md
    $ cat CREDENTIALS_GUIDE.md

4️⃣  Быстрый старт:
    $ cat QUICKSTART.md

════════════════════════════════════════════════════════════════════════════════
                             ПРОЕКТ ГОТОВ К РАЗРАБОТКЕ!
════════════════════════════════════════════════════════════════════════════════

Версия: 1.0.0
Создано: Декабрь 2024
Для: PBK Construction
Домен: https://crm.pbkconstruction.net
Локация: /root/pbk-crm-unified/

Начните с: cat START_HERE.md 🚀
